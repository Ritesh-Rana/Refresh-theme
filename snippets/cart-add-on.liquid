<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

{% assign free_gift_over_price_30 = 40 %}
{% assign variant_id = '44979149275425' %}

<script>
  (function($) {
    var cartItems = {{ cart.items | json }},
      qtyInTheCart = 0,
      cartUpdatesadd = {
        {{ variant_id }}: 1
      },
      cartUpdatesremove = {
        {{ variant_id }}: 0
      },
      cartTotal = {{ cart.total_price | money_without_currency }};
    for (var i = 0; i < cartItems.length; i++) {
      if (cartItems[i].id === {{ variant_id }}) {
        console.log("free item found");
        qtyInTheCart = cartItems[i].quantity;
        break;
      }
    }

    if (cartTotal >= {{ free_gift_over_price_30 }}) {
      data = {
        "id": variant_id,
        "quantity": 1
      }
      jQuery.ajax({
        type: 'POST',
        url: '/cart/add',
        data: data,
        dataType: 'json',
        success: function() {
          alert("Free product added to cart")
          event.preventDefault();
        }
      });
    } else {
      data = {
        "id": variant_id,
        "quantity": 0
      }
      jQuery.ajax({
        type: 'POST',
        url: '/cart/add',
        data: data,
        dataType: 'json',
        success: function() {
          alert("Free product removed from cart")
          event.preventDefault();
        }
      });
    }
    event.preventDefault();
  });
</script>