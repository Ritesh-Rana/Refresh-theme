<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

{% assign free_gift_over_price_30 = 40 %} 
{% assign variant_id = '44979149275425' %}

  <script>
  (function($) {
    var cartItems = {{ cart.items | json }},
        qtyInTheCart = 0,
        cartUpdatesadd = { {{ variant_id }}: 1 },
        cartUpdatesremove = { {{ variant_id }}: 0 },
        cartTotal = {{ cart.total_price | money_without_currency }};
    for (var i=0; i<cartItems.length; i++) {
      if ( cartItems[i].id === {{ variant_id }} ) {
        console.log("free item found");
        qtyInTheCart = cartItems[i].quantity;
        break;
      }
    }

    var add = {
      type: 'POST',
      url: '/cart/add',
      data: { updates: cartUpdatesadd },
      dataType: 'json',
      success: function(stuff) { 
        window.location.href = '/cart';
      }
    };
    var remove = {
      type: 'POST',
      url: '/cart/change',
      data: { updates: cartUpdatesremove },
      dataType: 'json',
      success: function(stuff) { 
        window.location.href = '/cart';
      }
    };
    if(qtyInTheCart!==1 && cartTotal>={{ free_gift_over_price_30 }}){
        $.ajax(add);
    }
    if(cartTotal<{{ free_gift_over_price_30 }}){
        $.ajax(remove);
    }
  })(jQuery);
  </script>